import{_ as B,m as E,R as L,P as z}from"./icon-star-full-c1f913e3.js";import{_ as $,o as d,c as r,F as k,h as y,a as t,m as S,r as p,t as l,b as g,g as v,w as T,n as u,d as _,l as f,v as R,x as C,p as A,f as N,k as P,j as x,e as O,i as M}from"./index-b93c5667.js";import{d as I}from"./drinkStore-973bcf5a.js";import{c as w,C as q}from"./CommentDisplay-7d9b4888.js";import{F as H}from"./FavoriteBtn-02a8c7db.js";import{R as J}from"./RateDisplay-55162780.js";import"./bootstrap.esm-5705fa0f.js";import"./icon-favorite-active-69e4f444.js";const K="/whatToDrink/assets/icon-star-empty-8c79ce5f.svg";const Q={props:["rate"],watch:{rate(){if(this.rate==="0"){const e=this.$refs.rateSelector;for(let o=0;o<e.length;o+=1)e[o].checked=!1}}},methods:{selectRate(e){this.$emit("emit-rate",e.target.value)}}},W={class:"rateSelector list-unstyled mb-0"},X=["id","value"],Y=["for"],Z=["alt"],tt=["alt"];function et(e,o,n,h,s,m){return d(),r("ul",W,[(d(),r(k,null,y([5,4,3,2,1],c=>t("li",{class:"rateSelector-item me-1",key:`rate ${c}`},[t("input",{class:"rateSelector-input",type:"radio",name:"rating",id:`rating-${c}`,value:`${c}`,onClick:o[0]||(o[0]=(...a)=>m.selectRate&&m.selectRate(...a)),ref_for:!0,ref:"rateSelector"},null,8,X),t("label",{class:"rateSelector-label",for:`rating-${c}`},[t("img",{class:"rateSelector-img rateSelector-img-empty",src:K,alt:`rating-empty-${c}`},null,8,Z),t("img",{class:"rateSelector-img rateSelector-img-full",src:B,alt:`rating-full-${c}`},null,8,tt)],8,Y)])),64))])}const ot=$(Q,[["render",et],["__scopeId","data-v-a4bf9846"]]);const st={data(){return{firstSend:!1,addDate:{rate:"0",userName:"",sugar:"甜度",ice:"冰塊",content:""}}},components:{RateSelector:ot},props:{propsData:{type:Object,default(){return{}}}},mixins:[E],methods:{...S(w,["postComment"]),getSelectRate(e){this.addDate.rate=e},sendComment(){if(this.firstSend=!0,this.hasData){const e={...this.propsData},o={id:e.shop.id,rate:e.shop.rate,rateNum:e.shop.rateNum},n={id:e.id,rate:e.rate,rateNum:e.comments.length};this.addDate={...this.addDate,shopId:e.shop.id,drinkId:e.id,date:new Date*1},this.postComment(this.addDate,n,o),this.modal.hide(),this.firstSend=!1,this.addDate={rate:"0",userName:"",sugar:"甜度",ice:"冰塊",content:""}}}},computed:{hasData(){const e={...this.addDate},o=Object.keys(e),n=[];for(let h=0;h<o.length;h+=1)e.rate==="0"&&n.push(!1),e.userName===""&&n.push(!1),e.sugar==="甜度"&&n.push(!1),e.ice==="冰塊"&&n.push(!1),e.content===""&&n.push(!1);return!n.length}}},D=e=>(A("data-v-c0631310"),e=e(),N(),e),nt={class:"modal fade",id:"addCommentModal",ref:"modal"},at={class:"modal-dialog modal-lg modal-dialog-centered"},it={class:"modal-content rounded-4"},lt={class:"modal-header border-bottom-0 pb-2 p-lg-4"},dt=D(()=>t("h1",{class:"modal-title fs-5 invisible",id:"addCommentModalLabel"},"撰寫評論",-1)),ct={class:"modal-body pt-0 pb-10"},rt={class:"container-fluid"},mt={class:"row flex-column flex-lg-row gx-lg-10 justify-content-center"},pt={class:"col-12 col-lg-4"},ut=["src","alt"],_t={class:"py-2 px-4 mb-3 d-inline-block fs-normal2 fw-normal border border-gray-900 rounded-pill"},ht={class:"drinkInfo pb-4 pb-lg-0 mb-4 mb-lg-0"},ft={class:"fs-5 mb-0 mb-lg-3"},gt={class:"fs-normal2 fs-lg-6 fw-medium"},bt={key:0},vt={class:"ms-2"},Dt={key:1,class:"mx-3"},kt={key:2},yt={class:"ms-2"},St={class:"d-flex flex-column flex-lg-row align-items-lg-center mb-6"},Ct={class:"d-flex align-items-center"},wt=D(()=>t("p",{class:"mt-2 mt-lg-0 ms-lg-2 py-1 px-4 rounded-pill"}," 請選擇評價 ",-1)),$t=[wt],Rt={class:"row gx-3 align-items-center mb-4"},xt={class:"col-12 col-lg-4 mb-4 mb-lg-0"},Mt=D(()=>t("label",{for:"addCommentName",class:"form-label fs-5 mb-0 me-3 fw-medium d-none"}," 姓名 ",-1)),It={class:"col-6 col-lg-4"},At=P('<option selected disabled data-v-c0631310>甜度</option><option value="無糖" data-v-c0631310>無糖</option><option value="1 分糖" data-v-c0631310>1 分糖</option><option value="微糖" data-v-c0631310>微糖</option><option value="半糖" data-v-c0631310>半糖</option><option value="少糖" data-v-c0631310>少糖</option><option value="全糖" data-v-c0631310>全糖</option><option value="多糖" data-v-c0631310>多糖</option><option value="不記得" data-v-c0631310>不記得</option>',9),Nt=[At],Pt={class:"col-6 col-lg-4"},jt=P('<option selected disabled data-v-c0631310>冰塊</option><option value="完全去冰" data-v-c0631310>完全去冰</option><option value="去冰" data-v-c0631310>去冰</option><option value="微冰" data-v-c0631310>微冰</option><option value="半冰" data-v-c0631310>半冰</option><option value="少冰" data-v-c0631310>少冰</option><option value="多冰" data-v-c0631310>多冰</option><option value="溫" data-v-c0631310>溫</option><option value="熱" data-v-c0631310>熱</option><option value="不記得" data-v-c0631310>不記得</option>',10),Vt=[jt],Gt={class:"d-flex align-items-center justify-content-end"},Ft=D(()=>t("button",{type:"submit",form:"addCommentForm",class:"btn-custom btn-custom-primary-sm fw-medium"}," 確定送出 ",-1));function Ut(e,o,n,h,s,m){const c=p("RateSelector");return d(),r("div",nt,[t("div",at,[t("div",it,[t("div",lt,[dt,t("button",{type:"button",class:"btn-close",onClick:o[0]||(o[0]=(...a)=>e.hideModal&&e.hideModal(...a))})]),t("div",ct,[t("div",rt,[t("div",mt,[t("div",pt,[t("img",{class:"img-full mb-3 d-none d-lg-block",style:{height:"200px"},src:n.propsData.imageUrl,alt:n.propsData.name},null,8,ut),t("h3",_t,l(n.propsData.shop.name),1),t("div",ht,[t("h2",ft,l(n.propsData.name),1),t("p",gt,[n.propsData.price.m?(d(),r("span",bt,[g(" M "),t("span",vt,"$ "+l(n.propsData.price.m),1)])):v("",!0),n.propsData.price.m&&n.propsData.price.l?(d(),r("span",Dt,"｜")):v("",!0),n.propsData.price.l?(d(),r("span",kt,[g(" L "),t("span",yt,"$ "+l(n.propsData.price.l),1)])):v("",!0)])])]),t("form",{id:"addCommentForm",class:"col-12 col-lg-8",onSubmit:o[6]||(o[6]=T((...a)=>m.sendComment&&m.sendComment(...a),["prevent"]))},[t("div",St,[t("div",Ct,[t("h4",{class:u(["fs-5 me-3 transition-ease",{"text-accent-700":s.addDate.rate==="0"&&s.firstSend}])}," 評價星等 ",2),_(c,{rate:s.addDate.rate,onEmitRate:m.getSelectRate},null,8,["rate","onEmitRate"])]),t("div",{class:u(["rateAlert",{active:s.addDate.rate==="0"&&s.firstSend}])},$t,2)]),t("div",Rt,[t("div",xt,[Mt,f(t("input",{type:"text",class:u(["form-item form-control flex-fit py-2 px-4 rounded-pill",{"border-accent-600 bg-accent-100":s.addDate.userName===""&&s.firstSend}]),id:"addCommentName",placeholder:"暱稱","onUpdate:modelValue":o[1]||(o[1]=a=>s.addDate.userName=a)},null,2),[[R,s.addDate.userName,void 0,{trim:!0}]])]),t("div",It,[f(t("select",{id:"type",class:u(["form-item form-select py-2 px-4 rounded-pill",{"border-accent-600 bg-accent-100":s.addDate.sugar==="甜度"&&s.firstSend}]),"onUpdate:modelValue":o[2]||(o[2]=a=>s.addDate.sugar=a)},Nt,2),[[C,s.addDate.sugar]])]),t("div",Pt,[f(t("select",{id:"type",class:u(["form-item form-select py-2 px-4 rounded-pill",{"border-accent-600 bg-accent-100":s.addDate.ice==="冰塊"&&s.firstSend}]),"onUpdate:modelValue":o[3]||(o[3]=a=>s.addDate.ice=a)},Vt,2),[[C,s.addDate.ice]])])]),f(t("textarea",{rows:"6",class:u(["form-item py-3 px-4 mb-4 w-100 rounded-4",{"border-accent-600 bg-accent-100":s.addDate.content===""&&s.firstSend}]),placeholder:"你覺得這杯飲料如何呢？","onUpdate:modelValue":o[4]||(o[4]=a=>s.addDate.content=a)},null,2),[[R,s.addDate.content]]),t("div",Gt,[t("button",{type:"button",class:"btn-custom btn-custom-light-sm fw-medium me-3",onClick:o[5]||(o[5]=(...a)=>e.hideModal&&e.hideModal(...a))}," 取消評論 "),Ft])],32)])])])])])],512)}const Bt=$(st,[["render",Ut],["__scopeId","data-v-c0631310"]]);const Et={data(){return{drinkId:0,sort:"最新日期"}},components:{RateDisplay:J,FavoriteBtn:H,RateGroup:L,CommentDisplay:q,AddCommentModal:Bt,PaginationComponent:z},props:["id"],watch:{singleDrink(){this.sortAction(1),this.getRateGroupInfo(this.singleDrink.comments)},sort(){this.sortAction(1)},comments(){this.getSingleDrink(this.id),this.getRateGroupInfo(this.singleDrink.comments),this.sortAction(1)}},methods:{...S(I,["getSingleDrink","joinIngredient"]),...S(w,["getComments","getRateGroupInfo","clickPin","filterUserComment","clickPage","sortCommentsFn"]),sortAction(e){const o=[...this.singleDrink.comments];this.sortCommentsFn(o,this.sort,e)},clickPageAction(e){this.clickPage(e),this.sortAction(this.pagination.current),this.$router.push(`${this.$route.path}#drink-comments`)},clickRateAction(e){this.clickPin(e),this.sortAction(1),this.$router.push(`${this.$route.path}#drink-rateGroup`)}},computed:{...x(I,["singleDrink"]),...x(w,["comments","rateGroup","pagination","sortComments"])},created(){this.getSingleDrink(this.id),this.getComments()}},b=e=>(A("data-v-6ea34f73"),e=e(),N(),e),Lt={class:"container pt-8 pt-md-15 pb-8 pb-md-12"},zt={class:"row justify-content-center"},Tt={class:"col-12 col-lg-9 col-3xl-10"},Ot={class:"row"},qt={class:"col-12 col-lg-4 mb-3 mb-lg-0 drinkImg"},Ht=["src","alt"],Jt={class:"col-12 col-lg-8 d-flex flex-column justify-content-between"},Kt={class:"d-flex justify-content-between mb-0 mb-lg-8"},Qt={class:"py-2 px-5 mb-3 d-inline-block fs-normal2 fs-md-normal1 fw-normal border border-gray-900 rounded-pill"},Wt={class:"fs-4 fs-md-3 mb-3 mb-md-6"},Xt={class:"list-unstyled d-flex mb-5"},Yt={class:"pe-6 border-end border-black"},Zt={class:"mb-2 fs-normal1 fs-md-6 fw-medium"},te={class:"ms-4"},ee={class:"d-block text-gray-700 mb-1"},oe={class:"d-block text-gray-700"},se={class:"ps-6"},ne={class:"mb-2 fs-normal1 fs-md-6 fw-medium"},ae={class:"ms-4"},ie={class:"d-block text-gray-700 mb-1"},le={class:"d-block text-gray-700"},de={class:"list-unstyled d-flex"},ce={class:"text-end"},re={class:"list-unstyled mb-0"},me={class:"row justify-content-center pt-10 pt-md-15",id:"drink-rateGroup"},pe={class:"col-12 col-md-9 col-lg-10"},ue={class:"col-6 col-md-3 col-lg-2 d-flex align-items-center justify-content-center"},_e={class:"pt-15",id:"drink-comments"},he={class:"d-flex align-items-center justify-content-end mb-6"},fe=b(()=>t("label",{for:"type",class:"me-4 fw-medium"},"排序",-1)),ge=b(()=>t("option",{selected:"",value:"最新日期"},"最新日期",-1)),be=b(()=>t("option",{value:"評分最高"},"評分最高",-1)),ve=b(()=>t("option",{value:"最冰溫度"},"最冰溫度",-1)),De=b(()=>t("option",{value:"最少甜度"},"最少甜度",-1)),ke=[ge,be,ve,De];function ye(e,o,n,h,s,m){const c=p("RouterLink"),a=p("RateDisplay"),j=p("FavoriteBtn"),V=p("RateGroup"),G=p("CommentDisplay"),F=p("PaginationComponent"),U=p("AddCommentModal");return d(),r("div",Lt,[t("div",zt,[t("div",Tt,[t("section",Ot,[t("div",qt,[t("img",{class:"img-full",src:e.singleDrink.imageUrl,alt:e.singleDrink.name},null,8,Ht)]),t("div",Jt,[t("div",Kt,[t("div",null,[t("h3",Qt,[_(c,{to:`/shops/${e.singleDrink.shop.code}`},{default:O(()=>[g(l(e.singleDrink.shop.name),1)]),_:1},8,["to"])]),t("h2",Wt,l(e.singleDrink.name),1),t("ul",Xt,[t("li",Yt,[t("p",Zt,[g(" M "),t("span",te,"$ "+l(e.singleDrink.price.m),1)]),t("small",ee,l(e.singleDrink.shop.size.m),1),t("small",oe,l(e.singleDrink.calorie.m)+" 大卡 ",1)]),t("li",se,[t("p",ne,[g(" L "),t("span",ae,"$ "+l(e.singleDrink.price.l),1)]),t("small",ie,l(e.singleDrink.shop.size.l),1),t("small",le,l(e.singleDrink.calorie.l)+" 大卡 ",1)])]),t("ul",de,[(d(!0),r(k,null,y(e.singleDrink.special,i=>(d(),r("li",{class:u(["py-1 px-4 fs-normal2 fw-medium rounded-pill me-2",{"bg-primary-300":i==="期間限定","bg-secondary-300":i==="僅限冷飲","bg-accent-300":i==="店家推薦","bg-gray-100 border border-gray-500":i!=="期間限定"&&i!=="僅限冷飲"&&i!=="店家推薦"}]),key:`drinkSpecial ${i}`},l(i),3))),128))])]),t("div",ce,[_(a,{class:"rateDisplay-md mb-3 d-none d-md-block",rate:e.rateGroup.totalRateScore},null,8,["rate"]),_(j,{class:"btn-favorite",id:e.singleDrink.id},null,8,["id"])])]),t("ul",re,[t("li",null,"咖啡因："+l(e.singleDrink.caffeine?e.singleDrink.caffeine:"無咖啡因"),1),t("li",null,"內容物："+l(e.joinIngredient(e.singleDrink.ingredient)),1)])])]),t("section",me,[t("div",pe,[_(V,{data:e.rateGroup,onEmitPin:m.clickRateAction},null,8,["data","onEmitPin"])]),t("div",ue,[t("button",{type:"button",class:"btn-custom btn-custom-primary fs-6 fw-bold px-0 w-100 py-3",onClick:o[0]||(o[0]=(...i)=>e.$refs.addCommentModal.showModal&&e.$refs.addCommentModal.showModal(...i))}," 撰寫評論 ")])]),t("section",_e,[t("div",he,[fe,f(t("select",{id:"type",class:"form-select py-2 px-4 border-black rounded-pill",style:{"max-width":"180px"},"onUpdate:modelValue":o[1]||(o[1]=i=>s.sort=i)},ke,512),[[C,s.sort]])]),(d(!0),r(k,null,y(e.sortComments,i=>(d(),M(G,{class:"mb-15",key:`comments ${i.id}`,commentData:i},null,8,["commentData"]))),128)),e.pagination.total>1?(d(),M(F,{key:0,pagination:e.pagination,onEmitPage:m.clickPageAction},null,8,["pagination","onEmitPage"])):v("",!0)])])]),_(U,{ref:"addCommentModal",propsData:e.singleDrink},null,8,["propsData"])])}const Ae=$(Et,[["render",ye],["__scopeId","data-v-6ea34f73"]]);export{Ae as default};
