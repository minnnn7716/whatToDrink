import{_ as R,m as v,j as I,r as T,o as i,c as o,a as t,d as _,e as y,n as u,w,g as d,F as b,h as k,l as x,x as D,b as c,u as F,t as f,p as j,f as U}from"./index-b93c5667.js";import{s as S}from"./shopStore-965319e5.js";import{d as O}from"./drinkStore-973bcf5a.js";import{R as V}from"./RateDisplay-55162780.js";const B="/whatToDrink/assets/wheel-shop-6baf192f.webp",C="/whatToDrink/assets/wheel-drink-371411e0.webp",M="/whatToDrink/assets/wheel-drink-sm-948c0026.webp",H="/whatToDrink/assets/wheel-nodrink-2b90164f.svg";const L={data(){return{step:"",firstSend:!1,randomType:"",resultIndex:0,selectIngredient:{base:!1,mix:!1,material:!1},randomData:{price:{m:0,l:0}},filterDrinkData:{},noResult:!1}},components:{RateDisplay:V},watch:{$route:"judgePath",selectType(){this.getWheelOption(),this.typeChange()}},methods:{...v(S,["getShops"]),...v(O,["getDrinks","changeType","getWheelOption","changeFirstSelectType"]),typeChange(){const s=this.selectType;s==="請選擇"?this.selectIngredient={base:!1,mix:!1,material:!1}:s==="純茶"?this.selectIngredient={base:this.selectIngredient.base||"請選擇",mix:!1,material:!1}:s==="奶系列"||s==="特調"?this.selectIngredient={base:"請選擇",mix:"請選擇",material:!1}:this.selectIngredient={base:"請選擇",mix:"請選擇",material:"請選擇"}},judgePath(){const s=this.$route.fullPath;if(s.indexOf("?")===-1){this.step="wheelHome";return}const l=s.split("=")[1];this.step=l},randomFn(s){this.randomType=s;const l=[...this[`${s}s`]];if(this.$router.push("/wheel?=result"),this.filterDrinkData.length&&this.randomType==="drink"){this.randomData=this.randomIndex(this.filterDrinkData);return}this.noResult=!1,this.randomData=this.randomIndex(l)},randomIndex(s){const h=s.length,a=Math.floor(Math.random()*(h-0)+0);return s[a]},randomUrl(){let s="";return this.randomType==="shop"?s=`/shops/${this.randomData.code}`:this.randomType==="drink"&&(s=`/drink/${this.randomData.id}`),s},filterIngredient(s,l,h){let a=[];return s.length?h==="all"?a=s:h?a=s.filter(e=>e.ingredient[l].indexOf(h)!==-1):a=s.filter(e=>!e.ingredient[l].length):a=[],a},wheelDrink(){const s=this.selectType,l={...this.selectIngredient},h=Object.keys(l);let a=[];s==="隨機"?a=[...this.drinks]:a=this.drinks.filter(e=>e.type===s);for(let e=0;e<h.length;e+=1){const p=h[e],m=l[h[e]];let g=m;m==="隨機"||m==="請選擇"?g="all":(m==="不添加"||!m)&&(g=!1),a=this.filterIngredient(a,p,g)}this.filterDrinkData=a,a.length?(this.randomData={...this.randomIndex(a)},this.noResult=!1):(this.randomData={price:{m:0,l:0}},this.noResult=!0),this.$router.push("/wheel?=result")},sendSelect(){this.firstSend=!0,this.selectType!=="請選擇"&&this.changeFirstSelectType(!0),!(this.selectType==="請選擇"||!this.selectIngredient.base||this.selectIngredient.base==="請選擇"||this.selectIngredient.base==="")&&this.wheelDrink()},resetSelect(){this.changeType("請選擇"),this.selectIngredient={base:!1,mix:!1,material:!1},this.firstSend=!1,this.changeFirstSelectType(!1)}},computed:{...I(S,["shops"]),...I(O,["drinks","typeKind","wheelOptionData","selectType","firstSelectType"]),isBaseTrue(){let s=!0;return(!this.selectIngredient.base||this.selectIngredient.base==="請選擇"||this.selectIngredient.base==="")&&(s=!1),s}},created(){this.judgePath(),this.getShops(),this.getDrinks(),this.$route.query[""]==="select"&&(this.randomType="drink"),this.$route.query[""]==="result"&&this.randomType===""&&this.$router.push("/wheel")}},r=s=>(j("data-v-e21b9253"),s=s(),U(),s),N={class:"wheel d-flex flex-column"},P={class:"container pb-12 py-md-0"},W={class:"row justify-content-center"},K={key:0,class:"col-10 col-md-12 col-lg-8 col-3xl-10"},q={class:"d-none d-md-flex mb-6 d-flex align-items-center justify-content-between"},z=r(()=>t("h2",{class:"title-angleStar-dark fs-4"},"轉轉轉，飲料跟著一起來～",-1)),A={key:0,class:"row gy-6 gy-md-0 gx-lg-12 pt-10 pt-md-0"},E={class:"col-12 col-md-6 wheel-home-btn"},G=r(()=>t("img",{class:"img-fluid",src:B,alt:"隨機店家轉盤"},null,-1)),J=[G],Q={class:"col-12 col-md-6 wheel-home-btn"},X={href:"#"},Y=r(()=>t("img",{class:"img-fluid",src:C,alt:"隨機飲品轉盤"},null,-1)),Z={key:1,class:"row gx-8"},$=r(()=>t("div",{class:"col-12 col-md-6 pt-10 pt-md-0"},[t("img",{class:"img-fluid d-none d-md-block",src:C,alt:"隨機飲品轉盤"}),t("img",{class:"img-fluid d-md-none mb-6",src:M,alt:"隨機飲品轉盤"})],-1)),ee={class:"col-12 col-md-6"},te={class:"d-flex align-items-center mb-6"},se=r(()=>t("label",{for:"type",class:"me-2 me-md-4 fw-medium"},[c(" 飲料種類 "),t("span",{class:"fs-5 text-accent-600"},"*")],-1)),le=r(()=>t("option",{selected:"",disabled:""},"請選擇",-1)),ne=r(()=>t("option",null,"隨機",-1)),ie=["value"],oe=r(()=>t("label",{for:"base",class:"me-2 me-md-4 fw-medium"},[c(" 基底飲品 "),t("span",{class:"fs-5 text-accent-600"},"*")],-1)),re=["disabled"],ae=r(()=>t("option",{selected:"",disabled:""},"請選擇",-1)),de=r(()=>t("option",null,"隨機",-1)),ce=["value"],me=r(()=>t("label",{for:"mix",class:"me-2 me-md-4 fw-medium"},[c(" 調和飲料 "),t("span",{class:"fs-5 invisible"},"*")],-1)),he=["disabled"],pe={key:0,selected:"",disabled:""},fe={key:1},ue=r(()=>t("option",null,"不添加",-1)),_e=["value"],ge=r(()=>t("label",{for:"material",class:"me-2 me-md-4 fw-medium"},[c(" 各種好料 "),t("span",{class:"fs-5 invisible"},"*")],-1)),ye=["disabled"],be={key:0,selected:"",disabled:""},ke={key:1},we=r(()=>t("option",null,"不添加",-1)),xe=["value"],De={class:"d-flex align-items-center justify-content-end"},ve=r(()=>t("br",null,null,-1)),Ie=r(()=>t("button",{type:"submit",form:"drinkSelectForm",class:"btn-circle bg-accent fs-normal2 fs-md-6 fw-medium"}," 轉吧 ",-1)),Te={key:1,class:"wheel-result col-11 col-md-8 col-lg-5 col-3xl-6 mb-20 mb-md-0"},Se={key:0},Oe={key:0,class:"img-full",src:H,alt:"查無結果"},Ce={key:1},Re=["src","alt"],Fe=["src","alt"],je={class:"wheel-result-content-title title-stroke-2 fs-4 fs-md-3 fw-bold"},Ue={key:0,class:"pt-3 pb-2 px-1 px-md-2 bg-white border border-gray-900 rounded-pill fs-normal2 fs-md-normal1"},Ve={key:2,class:"wheel-result-content-info fs-5 fs-md-4 font-handwriting fw-bold title-stroke-2"},Be={key:0},Me={class:"ms-2"},He={key:1},Le={key:2},Ne={class:"ms-2"},Pe={class:"wheel-result-btnGroup d-flex flex-md-column"},We=r(()=>t("br",null,null,-1)),Ke=r(()=>t("br",null,null,-1));function qe(s,l,h,a,e,p){const m=T("RouterLink"),g=T("RateDisplay");return i(),o("div",N,[t("div",{class:u(["flex-grow-1 d-flex align-items-center",{"wheel-result-bg":e.step==="result"}])},[t("div",P,[t("div",W,[e.step==="wheelHome"||e.step==="select"?(i(),o("div",K,[t("div",q,[z,_(m,{to:"/wheel",class:u(["btn-custom btn-custom-primary-sm fw-bold opacity-0",{"opacity-100":e.step==="select"}])},{default:y(()=>[c(" 返回 ")]),_:1},8,["class"])]),e.step==="wheelHome"?(i(),o("div",A,[t("div",E,[t("a",{href:"#",onClick:l[0]||(l[0]=w(n=>p.randomFn("shop"),["prevent"]))},J)]),t("div",Q,[t("a",X,[_(m,{to:"/wheel?=select",href:"#",onClick:l[1]||(l[1]=w(n=>e.randomType="drink",["prevent"]))},{default:y(()=>[Y]),_:1})])])])):d("",!0),e.step==="select"?(i(),o("div",Z,[$,t("div",ee,[t("form",{id:"drinkSelectForm",class:"d-flex flex-column justify-content-between h-100",onSubmit:l[7]||(l[7]=w((...n)=>p.sendSelect&&p.sendSelect(...n),["prevent"]))},[t("div",null,[t("div",te,[se,t("select",{id:"type",class:u(["form-select py-2 py-md-3 px-4 flex-fit rounded-pill",{"bg-accent-100 border-2 border-accent-600":e.firstSend&&s.selectType==="請選擇"}]),onChange:l[2]||(l[2]=n=>s.changeType(s.$refs.typeSelect.value)),ref:"typeSelect"},[le,ne,(i(!0),o(b,null,k(s.typeKind,n=>(i(),o("option",{key:`wheelOption.type ${n}`,value:n},f(n),9,ie))),128))],34)]),t("div",{class:u(["d-flex align-items-center mb-6",{"opacity-50":s.selectType==="請選擇"}])},[oe,x(t("select",{id:"base",class:u(["form-select py-2 py-md-3 px-4 flex-fit rounded-pill",{"bg-accent-100 border-2 border-accent-600":e.firstSend&&!p.isBaseTrue&&s.firstSelectType}]),"onUpdate:modelValue":l[3]||(l[3]=n=>e.selectIngredient.base=n),disabled:s.selectType==="請選擇"},[ae,de,(i(!0),o(b,null,k(s.wheelOptionData.base,n=>(i(),o("option",{key:`wheelOption.base ${n}`,value:n},f(n),9,ce))),128))],10,re),[[D,e.selectIngredient.base]])],2),t("div",{class:u(["d-flex align-items-center mb-6",{"opacity-50":!e.selectIngredient.mix}])},[me,x(t("select",{id:"mix",class:"form-select py-2 py-md-3 px-4 flex-fit rounded-pill","onUpdate:modelValue":l[4]||(l[4]=n=>e.selectIngredient.mix=n),disabled:!e.selectIngredient.mix},[e.selectIngredient.mix==="請選擇"?(i(),o("option",pe," 請選擇 ")):d("",!0),s.wheelOptionData.mix.length?(i(),o("option",fe,"隨機")):d("",!0),ue,(i(!0),o(b,null,k(s.wheelOptionData.mix,n=>(i(),o("option",{key:`wheelOption.mix ${n}`,value:n},f(n),9,_e))),128))],8,he),[[D,e.selectIngredient.mix]])],2),t("div",{class:u(["d-flex align-items-center mb-6",{"opacity-50":!e.selectIngredient.material}])},[ge,x(t("select",{id:"material",class:"form-select py-2 py-md-3 px-4 flex-fit rounded-pill","onUpdate:modelValue":l[5]||(l[5]=n=>e.selectIngredient.material=n),disabled:!e.selectIngredient.material},[e.selectIngredient.material==="請選擇"?(i(),o("option",be," 請選擇 ")):d("",!0),s.wheelOptionData.material.length?(i(),o("option",ke,"隨機")):d("",!0),we,(i(!0),o(b,null,k(s.wheelOptionData.material,n=>(i(),o("option",{key:`wheelOption.material ${n}`,value:n},f(n),9,xe))),128))],8,ye),[[D,e.selectIngredient.material]])],2)]),t("div",De,[t("button",{type:"button",class:"btn-circle bg-gray-700 text-white fs-normal2 fs-md-6 fw-medium me-4 lh-sm",onClick:l[6]||(l[6]=n=>p.randomFn("drink"))},[c(" 全部"),ve,c("隨機 ")]),Ie])],32)])])):d("",!0)])):d("",!0),e.step==="result"?(i(),o("div",Te,[e.noResult?(i(),o("div",Se,[_(m,{to:"/wheel?=select",class:"wheel-result-content"},{default:y(()=>[e.randomType==="drink"?(i(),o("img",Oe)):d("",!0)]),_:1})])):(i(),o("div",Ce,[_(m,{to:p.randomUrl(),href:"#",class:"wheel-result-content link-black",style:F({"background-color":e.randomData.bgColor})},{default:y(()=>[e.randomType==="drink"?(i(),o("img",{key:0,class:"img-full",src:e.randomData.imageUrl,alt:e.randomData.name},null,8,Re)):(i(),o("img",{key:1,class:"img-fluid",src:e.randomData.imageUrl,alt:e.randomData.name},null,8,Fe)),t("div",null,[t("h5",je,[c(f(e.randomData.name)+" ",1),e.randomType==="drink"?(i(),o("span",Ue,f(s.shops[e.randomData.shopId-1]?s.shops[e.randomData.shopId-1].name:""),1)):d("",!0)])]),e.randomType==="drink"?(i(),o("p",Ve,[e.randomData.price.m?(i(),o("span",Be,[c(" M "),t("span",Me,"$ "+f(e.randomData.price.m),1)])):d("",!0),e.randomData.price.m&&e.randomData.price.l?(i(),o("span",He," ｜ ")):d("",!0),e.randomData.price.l?(i(),o("span",Le,[c(" L "),t("span",Ne,"$ "+f(e.randomData.price.l),1)])):d("",!0)])):d("",!0),_(g,{class:"wheel-result-content-rate rateDisplay-lg hasHandText title-stroke-2",rate:e.randomData.rate},null,8,["rate"])]),_:1},8,["to","style"])])),t("div",Pe,[e.noResult?d("",!0):(i(),o("button",{key:0,type:"button",class:"me-3 me-md-0 mb-md-4 btn-circle bg-accent fs-normal2 fs-md-6 fw-medium lh-sm",onClick:l[8]||(l[8]=n=>p.randomFn(e.randomType))},[c(" 再轉"),We,c("一次 ")])),_(m,{to:"/wheel",type:"button",class:"btn-circle bg-gray-700 text-white fs-normal2 fs-md-6 fw-medium mb-md-4 lh-sm",onClick:p.resetSelect},{default:y(()=>[c(" 重新"),Ke,c("選擇 ")]),_:1},8,["onClick"])])])):d("",!0)])])],2)])}const Je=R(L,[["render",qe],["__scopeId","data-v-e21b9253"]]);export{Je as default};
