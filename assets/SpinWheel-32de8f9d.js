import{_ as R,m as x,g as I,r as T,o as i,c as o,a as t,d as _,e as y,n as f,w,i as c,F as b,h as k,l as D,x as v,b as d,u as F,t as u,p as j,f as U}from"./index-8e561d10.js";import{s as S}from"./shopStore-0a3d5c27.js";import{d as O}from"./drinkStore-bd8b6d11.js";import{R as V}from"./RateDisplay-19375105.js";const B="/whatToDrink/assets/wheel-shop-6baf192f.webp",C="/whatToDrink/assets/wheel-drink-371411e0.webp",M="/whatToDrink/assets/wheel-nodrink-60d72070.svg";const H={data(){return{step:"",firstSend:!1,randomType:"",resultIndex:0,selectIngredient:{base:!1,mix:!1,material:!1},randomData:{price:{m:0,l:0}},filterDrinkData:{},noResult:!1}},components:{RateDisplay:V},watch:{$route:"judgePath",selectType(){this.getWheelOption(),this.typeChange()}},methods:{...x(S,["getShops"]),...x(O,["getDrinks","changeType","getWheelOption","changeFirstSelectType"]),typeChange(){const s=this.selectType;s==="請選擇"?this.selectIngredient={base:!1,mix:!1,material:!1}:s==="純茶"?this.selectIngredient={base:this.selectIngredient.base||"請選擇",mix:!1,material:!1}:s==="奶系列"||s==="特調"?this.selectIngredient={base:"請選擇",mix:"請選擇",material:!1}:this.selectIngredient={base:"請選擇",mix:"請選擇",material:"請選擇"}},judgePath(){const s=this.$route.fullPath;if(s.indexOf("?")===-1){this.step="wheelHome";return}const l=s.split("=")[1];this.step=l},randomFn(s){this.randomType=s;const l=[...this[`${s}s`]];if(this.$router.push("/wheel?=result"),this.filterDrinkData.length&&this.randomType==="drink"){this.randomData=this.randomIndex(this.filterDrinkData);return}this.noResult=!1,this.randomData=this.randomIndex(l)},randomIndex(s){const m=s.length,a=Math.floor(Math.random()*(m-0)+0);return s[a]},randomUrl(){let s="";return this.randomType==="shop"?s=`/shops/${this.randomData.code}`:this.randomType==="drink"&&(s=`/drink/${this.randomData.id}`),s},filterIngredient(s,l,m){let a=[];return s.length?m==="all"?a=s:m?a=s.filter(e=>e.ingredient[l].indexOf(m)!==-1):a=s.filter(e=>!e.ingredient[l].length):a=[],a},wheelDrink(){const s=this.selectType,l={...this.selectIngredient},m=Object.keys(l);let a=[];s==="隨機"?a=[...this.drinks]:a=this.drinks.filter(e=>e.type===s);for(let e=0;e<m.length;e+=1){const p=m[e],h=l[m[e]];let g=h;h==="隨機"||h==="請選擇"?g="all":(h==="不添加"||!h)&&(g=!1),a=this.filterIngredient(a,p,g)}this.filterDrinkData=a,a.length?(this.randomData={...this.randomIndex(a)},this.noResult=!1):(this.randomData={price:{m:0,l:0}},this.noResult=!0),this.$router.push("/wheel?=result")},sendSelect(){this.firstSend=!0,this.selectType!=="請選擇"&&this.changeFirstSelectType(!0),!(this.selectType==="請選擇"||!this.selectIngredient.base||this.selectIngredient.base==="請選擇"||this.selectIngredient.base==="")&&this.wheelDrink()},resetSelect(){this.changeType("請選擇"),this.selectIngredient={base:!1,mix:!1,material:!1},this.firstSend=!1,this.changeFirstSelectType(!1)}},computed:{...I(S,["shops"]),...I(O,["drinks","typeKind","wheelOptionData","selectType","firstSelectType"]),isBaseTrue(){let s=!0;return(!this.selectIngredient.base||this.selectIngredient.base==="請選擇"||this.selectIngredient.base==="")&&(s=!1),s}},created(){this.judgePath(),this.getShops(),this.getDrinks(),this.$route.query[""]==="select"&&(this.randomType="drink"),this.$route.query[""]==="result"&&this.randomType===""&&this.$router.push("/wheel")}},r=s=>(j("data-v-cdf8618d"),s=s(),U(),s),L={class:"wheel d-flex flex-column"},N={class:"container"},P={class:"row justify-content-center"},W={key:0,class:"col-8 col-3xl-10"},K={class:"mb-6 d-flex align-items-center justify-content-between"},q=r(()=>t("h2",{class:"title-angleStar-dark fs-4"},"轉轉轉，飲料跟著一起來～",-1)),z={key:0,class:"row gx-12"},A={class:"col-6 wheel-home-btn"},E=r(()=>t("img",{class:"img-fluid",src:B,alt:"隨機店家轉盤"},null,-1)),G=[E],J={class:"col-6 wheel-home-btn"},Q={href:"#"},X=r(()=>t("img",{class:"img-fluid",src:C,alt:"隨機飲品轉盤"},null,-1)),Y={key:1,class:"row gx-8"},Z=r(()=>t("div",{class:"col-6"},[t("img",{class:"img-fluid",src:C,alt:"隨機飲品轉盤"})],-1)),$={class:"col-6"},ee={class:"d-flex align-items-center mb-6"},te=r(()=>t("label",{for:"type",class:"me-4 fw-medium"},[d(" 飲料種類 "),t("span",{class:"fs-5 text-accent-600"},"*")],-1)),se=r(()=>t("option",{selected:"",disabled:""},"請選擇",-1)),le=r(()=>t("option",null,"隨機",-1)),ne=["value"],ie=r(()=>t("label",{for:"base",class:"me-4 fw-medium"},[d(" 基底飲品 "),t("span",{class:"fs-5 text-accent-600"},"*")],-1)),oe=["disabled"],re=r(()=>t("option",{selected:"",disabled:""},"請選擇",-1)),ae=r(()=>t("option",null,"隨機",-1)),ce=["value"],de=r(()=>t("label",{for:"mix",class:"me-4 fw-medium"},[d(" 調和飲料 "),t("span",{class:"fs-5 invisible"},"*")],-1)),he=["disabled"],me={key:0,selected:"",disabled:""},pe={key:1},ue=r(()=>t("option",null,"不添加",-1)),fe=["value"],_e=r(()=>t("label",{for:"material",class:"me-4 fw-medium"},[d(" 各種好料 "),t("span",{class:"fs-5 invisible"},"*")],-1)),ge=["disabled"],ye={key:0,selected:"",disabled:""},be={key:1},ke=r(()=>t("option",null,"不添加",-1)),we=["value"],De={class:"d-flex align-items-center justify-content-end"},ve=r(()=>t("br",null,null,-1)),xe=r(()=>t("button",{type:"submit",form:"drinkSelectForm",class:"btn-circle bg-accent fs-6 fw-medium"}," 轉吧 ",-1)),Ie={key:1,class:"wheel-result col-5 col-3xl-6"},Te={key:0},Se={key:0,class:"img-full",src:M,alt:"查無結果"},Oe={key:1},Ce=["src","alt"],Re=["src","alt"],Fe={class:"wheel-result-content-title title-stroke-2 fs-3 fw-bold"},je={key:0,class:"pt-3 pb-2 px-2 bg-white border border-gray-900 rounded-pill fs-normal1"},Ue={key:2,class:"wheel-result-content-info fs-4 font-handwriting fw-bold title-stroke-2"},Ve={key:0},Be={class:"ms-2"},Me={key:1},He={key:2},Le={class:"ms-2"},Ne={class:"wheel-result-btnGroup d-flex flex-column"},Pe=r(()=>t("br",null,null,-1)),We=r(()=>t("br",null,null,-1));function Ke(s,l,m,a,e,p){const h=T("RouterLink"),g=T("RateDisplay");return i(),o("div",L,[t("div",{class:f(["flex-grow-1 d-flex align-items-center",{"wheel-result-bg":e.step==="result"}])},[t("div",N,[t("div",P,[e.step==="wheelHome"||e.step==="select"?(i(),o("div",W,[t("div",K,[q,_(h,{to:"/wheel",class:f(["btn-custom btn-custom-primary-sm fw-bold opacity-0",{"opacity-100":e.step==="select"}])},{default:y(()=>[d(" 返回 ")]),_:1},8,["class"])]),e.step==="wheelHome"?(i(),o("div",z,[t("div",A,[t("a",{href:"#",onClick:l[0]||(l[0]=w(n=>p.randomFn("shop"),["prevent"]))},G)]),t("div",J,[t("a",Q,[_(h,{to:"/wheel?=select",href:"#",onClick:l[1]||(l[1]=w(n=>e.randomType="drink",["prevent"]))},{default:y(()=>[X]),_:1})])])])):c("",!0),e.step==="select"?(i(),o("div",Y,[Z,t("div",$,[t("form",{id:"drinkSelectForm",class:"d-flex flex-column justify-content-between h-100",onSubmit:l[7]||(l[7]=w((...n)=>p.sendSelect&&p.sendSelect(...n),["prevent"]))},[t("div",null,[t("div",ee,[te,t("select",{id:"type",class:f(["form-select py-3 px-4 flex-fit rounded-pill",{"bg-accent-100 border-2 border-accent-600":e.firstSend&&s.selectType==="請選擇"}]),onChange:l[2]||(l[2]=n=>s.changeType(s.$refs.typeSelect.value)),ref:"typeSelect"},[se,le,(i(!0),o(b,null,k(s.typeKind,n=>(i(),o("option",{key:`wheelOption.type ${n}`,value:n},u(n),9,ne))),128))],34)]),t("div",{class:f(["d-flex align-items-center mb-6",{"opacity-50":s.selectType==="請選擇"}])},[ie,D(t("select",{id:"base",class:f(["form-select py-3 px-4 flex-fit rounded-pill",{"bg-accent-100 border-2 border-accent-600":e.firstSend&&!p.isBaseTrue&&s.firstSelectType}]),"onUpdate:modelValue":l[3]||(l[3]=n=>e.selectIngredient.base=n),disabled:s.selectType==="請選擇"},[re,ae,(i(!0),o(b,null,k(s.wheelOptionData.base,n=>(i(),o("option",{key:`wheelOption.base ${n}`,value:n},u(n),9,ce))),128))],10,oe),[[v,e.selectIngredient.base]])],2),t("div",{class:f(["d-flex align-items-center mb-6",{"opacity-50":!e.selectIngredient.mix}])},[de,D(t("select",{id:"mix",class:"form-select py-3 px-4 flex-fit rounded-pill","onUpdate:modelValue":l[4]||(l[4]=n=>e.selectIngredient.mix=n),disabled:!e.selectIngredient.mix},[e.selectIngredient.mix==="請選擇"?(i(),o("option",me," 請選擇 ")):c("",!0),s.wheelOptionData.mix.length?(i(),o("option",pe,"隨機")):c("",!0),ue,(i(!0),o(b,null,k(s.wheelOptionData.mix,n=>(i(),o("option",{key:`wheelOption.mix ${n}`,value:n},u(n),9,fe))),128))],8,he),[[v,e.selectIngredient.mix]])],2),t("div",{class:f(["d-flex align-items-center mb-6",{"opacity-50":!e.selectIngredient.material}])},[_e,D(t("select",{id:"material",class:"form-select py-3 px-4 flex-fit rounded-pill","onUpdate:modelValue":l[5]||(l[5]=n=>e.selectIngredient.material=n),disabled:!e.selectIngredient.material},[e.selectIngredient.material==="請選擇"?(i(),o("option",ye," 請選擇 ")):c("",!0),s.wheelOptionData.material.length?(i(),o("option",be,"隨機")):c("",!0),ke,(i(!0),o(b,null,k(s.wheelOptionData.material,n=>(i(),o("option",{key:`wheelOption.material ${n}`,value:n},u(n),9,we))),128))],8,ge),[[v,e.selectIngredient.material]])],2)]),t("div",De,[t("button",{type:"button",class:"btn-circle bg-gray-700 text-white fs-6 fw-medium me-4 lh-sm",onClick:l[6]||(l[6]=n=>p.randomFn("drink"))},[d(" 全部"),ve,d("隨機 ")]),xe])],32)])])):c("",!0)])):c("",!0),e.step==="result"?(i(),o("div",Ie,[e.noResult?(i(),o("div",Te,[_(h,{to:"/wheel?=select",class:"wheel-result-content"},{default:y(()=>[e.randomType==="drink"?(i(),o("img",Se)):c("",!0)]),_:1})])):(i(),o("div",Oe,[_(h,{to:p.randomUrl(),href:"#",class:"wheel-result-content link-black",style:F({"background-color":e.randomData.bgColor})},{default:y(()=>[e.randomType==="drink"?(i(),o("img",{key:0,class:"img-full",src:e.randomData.imageUrl,alt:e.randomData.name},null,8,Ce)):(i(),o("img",{key:1,class:"img-fluid",src:e.randomData.imageUrl,alt:e.randomData.name},null,8,Re)),t("div",null,[t("h5",Fe,[d(u(e.randomData.name)+" ",1),e.randomType==="drink"?(i(),o("span",je,u(s.shops[e.randomData.shopId-1]?s.shops[e.randomData.shopId-1].name:""),1)):c("",!0)])]),e.randomType==="drink"?(i(),o("p",Ue,[e.randomData.price.m?(i(),o("span",Ve,[d(" M "),t("span",Be,"$ "+u(e.randomData.price.m),1)])):c("",!0),e.randomData.price.m&&e.randomData.price.l?(i(),o("span",Me," ｜ ")):c("",!0),e.randomData.price.l?(i(),o("span",He,[d(" L "),t("span",Le,"$ "+u(e.randomData.price.l),1)])):c("",!0)])):c("",!0),_(g,{class:"wheel-result-content-rate rateDisplay-lg hasHandText title-stroke-2",rate:e.randomData.rate},null,8,["rate"])]),_:1},8,["to","style"])])),t("div",Ne,[e.noResult?c("",!0):(i(),o("button",{key:0,type:"button",class:"mb-4 btn-circle bg-accent fs-6 fw-medium",onClick:l[8]||(l[8]=n=>p.randomFn(e.randomType))},[d(" 再轉"),Pe,d("一次 ")])),_(h,{to:"/wheel",type:"button",class:"btn-circle bg-gray-700 text-white fs-6 fw-medium mb-4 lh-sm",onClick:p.resetSelect},{default:y(()=>[d(" 重新"),We,d("選擇 ")]),_:1},8,["onClick"])])])):c("",!0)])])],2)])}const Ge=R(H,[["render",Ke],["__scopeId","data-v-cdf8618d"]]);export{Ge as default};
